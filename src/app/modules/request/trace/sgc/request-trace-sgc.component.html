<div class="flex flex-col flex-auto min-w-0">

  <!-- Header -->
  <div class="flex flex-col sm:flex-row flex-0 sm:items-center
    sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card
    dark:bg-transparent">
    <div class="flex-1 min-w-0">
      <!-- Breadcrumbs -->
      <div class="flex flex-wrap items-center font-medium">
        <div>
          <a class="whitespace-nowrap text-primary-500">Solicitud</a>
        </div>
        <div class="flex items-center ml-1 whitespace-nowrap">
          <mat-icon class="icon-size-5 text-secondary"
            [svgIcon]="'heroicons_solid:chevron-right'"></mat-icon>
          <a class="ml-1 text-primary-500">Seguimiento</a>
        </div>
      </div>
      <!-- Title -->
      <div class="mt-2">
        <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7
          sm:leading-10 truncate">
          Seguimiento
        </h2>
      </div>
    </div>
  </div>

  <!-- Main -->
  <div class="flex-auto p-6 sm:p-10">

    <div class="max-w-full">

      <div class="flex-auto p-6 sm:p-10">

        <div class="max-w-6xl">

          <mat-tab-group>
            <mat-tab *ngFor="let i of object.keys(data)" [label]="data[i].goal_description">
              <div class="flex flex-wrap w-full">
                <div class="flex w-2/3">
                  <div class="flex flex-col h-130 shadow rounded-2xl
                    overflow-hidden bg-card w-full mt-5">
                    <form [formGroup]="formControl">
                      <div class="m-5">
                        <!-- Course title & description -->
                        <div class="mt-4 text-lg font-medium">
                          <mat-form-field class="w-2/3 pr-2">
                            <mat-label>Breve descripcion del seguimiento</mat-label>
                            <input matInput name="goal_description" formControlName="goal_description" />
                          </mat-form-field>
                          <mat-form-field class="w-1/3 pr-2">
                            <mat-label>Avance</mat-label>
                            <input matInput type="number" name="percentage" formControlName="percentage" />
                          </mat-form-field>
                        </div>
                        <div class="w-12 h-1 my-6 border-t-2"></div>
                        <div class="flex overflow-y-auto">
                          <div class="w-full">
                            <mat-label>Seguimiento</mat-label>
                            <quill-editor [modules]="quillConfiguration" formControlName="follow_process_description"></quill-editor>
                          </div>
                        </div>
                      </div>
                    </form>
                    <!-- Footer -->
                    <div class="flex flex-col w-full mt-auto">
                      <!-- Course progress -->
                      <div class="relative h-0.5">
                        <div class="z-10 absolute inset-x-0 h-6 -mt-3"
                          [matTooltip]="getPercentage(trackings[data[i]]) / 100 | percent"
                          [matTooltipPosition]="'above'"
                          [matTooltipClass]="'-mb-0.5'"></div>
                        <mat-progress-bar class="h-0.5" [color]="getColor()" [value]="getPercentage(trackings[data[i]])"></mat-progress-bar>
                      </div>

                      <!-- Course launch button -->
                      <div class="px-6 py-4 text-right bg-gray-50
                        dark:bg-transparent">
                        <button mat-stroked-button (click)="create(i)">
                          <span class="inline-flex items-center">
                            <!-- Started -->
                            <ng-container>
                              <span>Publicar seguimiento</span>
                            </ng-container>

                            <mat-icon
                              class="ml-1.5 icon-size-5"
                              [svgIcon]="'heroicons_solid:arrow-sm-right'"></mat-icon>
                          </span>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="flex w-1/3">
                  <fuse-card class="flex overflow-y-auto flex-col-reverse
                    max-h-130 ml-5 mt-5 w-full">

                    <div class="px-6 py-4 text-right">
                      <button mat-button class="bg-primary text-white" (click)="new(i)">
                        <span class="inline-flex items-start">
                          <!-- Started -->
                          <ng-container>
                            <span>Nuevo seguimiento</span>
                          </ng-container>

                          <mat-icon
                            class="ml-1.5 icon-size-5 text-white"
                            [svgIcon]="'heroicons_solid:plus'"></mat-icon>
                        </span>
                      </button>
                    </div>
                    <div class="flex flex-col flex-auto flex-shrink">
                      <div class="flex items-center mt-2" *ngFor="let obj of trackings[i]; let index" [ngClass]="{'bg-gray-200': selectedIndex == index}" style="cursor: pointer;" (click)="setForm(obj, index)">
                        <!-- Low stock -->
                        <div
                          class="flex items-end ml-2 w-1 h-4 bg-red-200 rounded
                          overflow-hidden mr-2"
                          *ngIf="obj.percentage <39">
                          <div class="flex w-full h-1/3 bg-red-600"></div>
                        </div>
                        <!-- Medium stock -->
                        <div
                          class="flex items-end ml-2 w-1 h-4 bg-orange-200
                          rounded overflow-hidden mr-2"
                          *ngIf="obj.percentage>40 && obj.percentage<69">
                            <div class="flex w-full h-2/4 bg-orange-400"></div>
                          </div>
                          <!-- High stock -->
                          <div
                            class="flex items-end ml-2 w-1 h-4 bg-green-100
                            rounded overflow-hidden mr-2"
                            *ngIf="obj.percentage> 70">
                            <div class="flex w-full h-full bg-green-400"></div>
                          </div>
                          {{obj.percentage}}%
                          <div class="flex flex-col min-w-0 m-2 ml-5">
                            <div class="text-xl font-medium leading-none">{{obj.goal_description}}</div>
                            <div class="text-l truncate leading-none mt-1">{{formatDate(obj.created_at)}}</div>
                          </div>
                        </div>
                        <div class="flex items-center mt-2" *ngIf="data.length == 0">
                          <div class="flex flex-col min-w-0 m-2 ml-5">
                            <div class="text-xl text-center font-medium leading-none">
                              Todavia no has hecho nigun seguimiento!
                            </div>
                          </div>
                        </div>
                      </div>
                    </fuse-card>

                  </div>
                </div>
              </mat-tab>
            </mat-tab-group>


          </div>

        </div>

      </div>

    </div>

  </div>
