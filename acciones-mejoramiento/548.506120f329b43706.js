"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[548],{83548:(re,C,i)=>{i.r(C),i.d(C,{RequestCreateSGCModule:()=>ae,routes:()=>Q});var v=i(91553),A=i(90086),I=i(67348),U=i(58621),u=i(98727),R=i(85694),m=i(28167),_=i(59112),T=i(74383),G=i(83530),O=i(6515),D=i(16400),w=i(5934),Y=i(51382),n=i(49133),M=i(94296),B=i(23452),L=i(47508),b=i(92070),d=i(42657),e=i(83668),y=i(8870),x=i(73205),S=i(14038),P=i(69179),f=i(79851),W=i(86019),F=i(42318),g=i(12605),J=i(66289),$=i(6731);function E(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.description)}}function j(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.name)}}function H(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.description)}}function X(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.name)}}function k(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.description)}}function z(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.description)}}function K(a,s){if(1&a&&(e.TgZ(0,"mat-option",50),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.description)}}const N=function(){return{height:"450px"}};let V=(()=>{class a{constructor(t,o,l,r,p,Z,h){this._formBuilder=t,this._router=o,this._requestService=l,this._userService=r,this._selectableService=p,this._cdr=Z,this._alert=h,this.formFieldHelpers=[""],this.users=[],this.selectable={detectedFor:[],processLead:[],detectedIn:[],unfulfilledRequirement:[],actionType:[],howDetected:[],affectedProcess:[]},this.selectFilter="",this.base64File="",this.minDate=b().toDate(),this.requestFormControl=new n.cw({init_date:new n.NI(b(),[n.kI.required]),detected_date:new n.NI("",[n.kI.required]),detected_in_code:new n.NI("",[n.kI.required,d.Z]),detected_for_id:new n.NI("",[n.kI.required,d.Z]),unfulfilled_requirement_code:new n.NI("",[n.kI.required,d.Z]),process_lead_id:new n.NI("",[n.kI.required,d.Z]),affected_process_code:new n.NI("",[n.kI.required,d.Z]),how_detected_code:new n.NI("",[n.kI.required,d.Z]),action_type_code:new n.NI("",[n.kI.required,d.Z]),evidence_description:new n.NI("",[n.kI.required]),request_description:new n.NI("",[n.kI.required]),evidence_file:new n.NI("",[n.kI.required])}),this.loadSelectOptions(),this.requestFormControl.get("init_date").disable(),this.requestFormControl.get("evidence_description").valueChanges.subscribe({next:q=>{const c=document.getElementsByClassName("mat-tab-label-content")[0];this.requestFormControl.get("evidence_description").valid?c.setAttribute("style",""):c.setAttribute("style","color: red !important")}}),this.requestFormControl.get("request_description").valueChanges.subscribe({next:q=>{const c=document.getElementsByClassName("mat-tab-label-content")[1];this.requestFormControl.get("request_description").valid?c.setAttribute("style",""):c.setAttribute("style","color: red !important")}})}ngOnInit(){}displayUser(t){return t?t.name:""}displaySelectable(t){return t?t.description:""}loadSelectOptions(){this.loadUsers("detectedFor"),this.loadUsers("processLead"),this.loadSelectables("detectedIn"),this.loadSelectables("affectedProcess"),this.loadSelectables("howDetected"),this.loadSelectables("actionType"),this.loadSelectables("unfulfilledRequirement"),this.loadSelectables("detectedIn")}loadSelectables(t){this._selectableService.getSelectable(this.getselectableTable(t),this.getFilter(t)).subscribe({next:o=>{this.selects=[],o.data.forEach(l=>{this.selects.push(new L.t(l)),this._cdr.detectChanges()}),this.selectable[t]=[...this.selects]}})}loadUsers(t){this._userService.getUsers(this.getFilter(t)).subscribe({next:o=>{this.users=[],o.data.forEach(l=>{this.users.push(new B.T(l)),this._cdr.detectChanges()}),this.selectable[t]=[...this.users]}})}getFilter(t){return this.requestFormControl.value[{detectedFor:"detected_for_id",processLead:"process_lead_id",detectedIn:"detected_in_code",unfulfilledRequirement:"unfulfilled_requirement_code",actionType:"action_type_code",howDetected:"how_detected_code",affectedProcess:"affected_process_code"}[t]]}getselectableTable(t){return{detectedIn:"detected_places",unfulfilledRequirement:"unfulfilled_requirements",actionType:"action_types",howDetected:"detection_types",affectedProcess:"affected_processes"}[t]}getFormFieldHelpersAsString(){return this.formFieldHelpers.join(" ")}submit(){this.requestFormControl.valid?this._alert.confirmation("Estas a punto de crear una nueva solicitud.").afterClosed().subscribe({next:t=>{if(["confirmed"].includes(t)){this.requestFormControl.get("init_date").enable();const o=Object.assign({},this.requestFormControl.value);this.requestFormControl.get("init_date").disable(),o.detected_for_id=o.detected_for_id.id,o.process_lead_id=o.process_lead_id.id,o.detected_in_code=o.detected_in_code.code,o.unfulfilled_requirement_code=o.unfulfilled_requirement_code.code,o.action_type_code=o.action_type_code.code,o.how_detected_code=o.how_detected_code.code,o.affected_process_code=o.affected_process_code.code;const l=new M.q(o);l.evidence_file=this.base64File,l.request_type_code="SGC",this._requestService.createRequest(l).subscribe({next:r=>{console.log(`Correcto ${r.data}`),this._alert.sucess().afterClosed().subscribe({next:p=>{this._router.navigateByUrl(`/request/invoice/${r.data.id}`)}})},error:r=>{this._alert.error(r.message)}})}}}):this._alert.error("Algunos campos son obligatorios, revisa e intenta de nuevo.")}onChangeFilter(t,o){this.inputTimeout&&clearTimeout(this.inputTimeout),this.inputTimeout=setTimeout(()=>{o.includes("selectable")?this.loadSelectables(t):this.loadUsers(t)},500)}OnChangeFile(){let t=new FileReader;t.readAsDataURL(this.requestFormControl.value.evidence_file.files[0]),t.onload=()=>{this.base64File=t.result},t.onerror=function(o){console.log("Error: ",o)}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(n.qu),e.Y36(v.F0),e.Y36(y.s),e.Y36(x.K),e.Y36(S.o),e.Y36(e.sBO),e.Y36(P.c))},a.\u0275cmp=e.Xpm({type:a,selectors:[["request-create"]],decls:107,vars:34,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500"],[1,"ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex-auto","p-6","sm:p-10"],[1,"max-w-6xl"],[1,"flex","flex-col","mt-8","p-8","pb-4","bg-card","rounded-2xl","shadow","overflow-hidden",3,"formGroup"],[1,"w-full"],[1,"w-1/4","pl-2"],["matInput","","name","init_date","formControlName","init_date",3,"min","matDatepicker"],["matSuffix","",3,"for"],["picker1",""],[1,"w-1/4","pl-4"],["matInput","","name","detected_date","formControlName","detected_date",3,"matDatepicker"],["picker2",""],[1,"w-2/4","pl-4"],["matInput","","name","detected_in_code","formControlName","detected_in_code",3,"matAutocomplete","input"],[3,"displayWith"],["auto0","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"w-2/3","pl-2"],["matInput","","name","detected_for_id","formControlName","detected_for_id",3,"matAutocomplete","input"],["auto1","matAutocomplete"],[1,"w-1/3","pl-4"],["matInput","","name","unfulfilled_requirement_code","formControlName","unfulfilled_requirement_code",3,"matAutocomplete","input"],["auto3","matAutocomplete"],["matInput","","name","process_lead_id","formControlName","process_lead_id",3,"matAutocomplete","input"],["auto2","matAutocomplete"],["matInput","","name","affected_process_code","formControlName","affected_process_code",3,"matAutocomplete","input"],["auto4","matAutocomplete"],["matInput","","name","how_detected_code","formControlName","how_detected_code",3,"matAutocomplete","input"],["auto5","matAutocomplete"],["matInput","","name","action_type_code","formControlName","action_type_code",3,"matAutocomplete","input"],["auto6","matAutocomplete"],[1,"w-full","pl-2"],["placeholder","Evidencia","name","evidence_file","formControlName","evidence_file",3,"change"],["matSuffix",""],[1,"mt-5"],["id","evidence_description",3,"label"],[1,"w-full","pl-2","pb-5"],["name","evidence_description","formControlName","evidence_description",3,"styles"],["id","request_description",3,"label"],["name","request_description","formControlName","request_description",3,"styles"],["mat-button","",1,"bg-primary","text-white",3,"click"],[3,"value"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div"),e.TgZ(5,"a",4),e._uU(6,"Solicitud"),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Nueva"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"h2",9),e._uU(13," Nueva Solicitud "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",10),e.TgZ(15,"div",11),e.TgZ(16,"form",12),e.TgZ(17,"div",13),e.TgZ(18,"mat-form-field",14),e.TgZ(19,"mat-label"),e._uU(20,"Fecha inicio"),e.qZA(),e._UZ(21,"input",15),e._UZ(22,"mat-datepicker-toggle",16),e._UZ(23,"mat-datepicker",null,17),e.qZA(),e.TgZ(25,"mat-form-field",18),e.TgZ(26,"mat-label"),e._uU(27,"Fecha detecta"),e.qZA(),e._UZ(28,"input",19),e._UZ(29,"mat-datepicker-toggle",16),e._UZ(30,"mat-datepicker",null,20),e.qZA(),e.TgZ(32,"mat-form-field",21),e.TgZ(33,"mat-label"),e._uU(34,"Detectado en"),e.qZA(),e.TgZ(35,"input",22),e.NdJ("input",function(){return o.onChangeFilter("detectedIn","selectable")}),e.qZA(),e.TgZ(36,"mat-autocomplete",23,24),e.ynx(38),e.YNc(39,E,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(40,"div",13),e.TgZ(41,"mat-form-field",26),e.TgZ(42,"mat-label"),e._uU(43,"Detectado por "),e.qZA(),e.TgZ(44,"input",27),e.NdJ("input",function(){return o.onChangeFilter("detectedFor","user")}),e.qZA(),e.TgZ(45,"mat-autocomplete",23,28),e.ynx(47),e.YNc(48,j,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.TgZ(49,"mat-form-field",29),e.TgZ(50,"mat-label"),e._uU(51,"Requisito afectado"),e.qZA(),e.TgZ(52,"input",30),e.NdJ("input",function(){return o.onChangeFilter("unfulfilledRequirement","selectable")}),e.qZA(),e.TgZ(53,"mat-autocomplete",23,31),e.ynx(55),e.YNc(56,H,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"div",13),e.TgZ(58,"mat-form-field",26),e.TgZ(59,"mat-label"),e._uU(60,"Lider del proceso "),e.qZA(),e.TgZ(61,"input",32),e.NdJ("input",function(){return o.onChangeFilter("processLead","user")}),e.qZA(),e.TgZ(62,"mat-autocomplete",23,33),e.ynx(64),e.YNc(65,X,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.TgZ(66,"mat-form-field",29),e.TgZ(67,"mat-label"),e._uU(68,"Proceso afectado"),e.qZA(),e.TgZ(69,"input",34),e.NdJ("input",function(){return o.onChangeFilter("affectedProcess","selectable")}),e.qZA(),e.TgZ(70,"mat-autocomplete",23,35),e.ynx(72),e.YNc(73,k,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(74,"div",13),e.TgZ(75,"mat-form-field",26),e.TgZ(76,"mat-label"),e._uU(77,"Como se detecta "),e.qZA(),e.TgZ(78,"input",36),e.NdJ("input",function(){return o.onChangeFilter("howDetected","selectable")}),e.qZA(),e.TgZ(79,"mat-autocomplete",23,37),e.ynx(81),e.YNc(82,z,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.TgZ(83,"mat-form-field",29),e.TgZ(84,"mat-label"),e._uU(85,"Tipo de accion"),e.qZA(),e.TgZ(86,"input",38),e.NdJ("input",function(){return o.onChangeFilter("actionType","selectable")}),e.qZA(),e.TgZ(87,"mat-autocomplete",23,39),e.ynx(89),e.YNc(90,K,2,2,"mat-option",25),e.BQk(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(91,"div",13),e.TgZ(92,"mat-form-field",40),e.TgZ(93,"mat-label"),e._uU(94,"Evidencia"),e.qZA(),e.TgZ(95,"ngx-mat-file-input",41),e.NdJ("change",function(){return o.OnChangeFile()}),e.qZA(),e.TgZ(96,"mat-icon",42),e._uU(97,"folder"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(98,"mat-tab-group",43),e.TgZ(99,"mat-tab",44),e.TgZ(100,"div",45),e._UZ(101,"quill-editor",46),e.qZA(),e.qZA(),e.TgZ(102,"mat-tab",47),e.TgZ(103,"div",45),e._UZ(104,"quill-editor",48),e.qZA(),e.qZA(),e.qZA(),e.TgZ(105,"button",49),e.NdJ("click",function(){return o.submit()}),e._uU(106,"Crear una solicitud"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const l=e.MAs(24),r=e.MAs(31),p=e.MAs(37),Z=e.MAs(46),h=e.MAs(54),q=e.MAs(63),c=e.MAs(71),le=e.MAs(80),se=e.MAs(88);e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("formGroup",o.requestFormControl),e.xp6(5),e.Q6J("min",o.minDate)("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(6),e.Q6J("matDatepicker",r),e.xp6(1),e.Q6J("for",r),e.xp6(6),e.Q6J("matAutocomplete",p),e.xp6(1),e.Q6J("displayWith",o.displaySelectable),e.xp6(3),e.Q6J("ngForOf",o.selectable.detectedIn),e.xp6(5),e.Q6J("matAutocomplete",Z),e.xp6(1),e.Q6J("displayWith",o.displayUser),e.xp6(3),e.Q6J("ngForOf",o.selectable.detectedFor),e.xp6(4),e.Q6J("matAutocomplete",h),e.xp6(1),e.Q6J("displayWith",o.displaySelectable),e.xp6(3),e.Q6J("ngForOf",o.selectable.unfulfilledRequirement),e.xp6(5),e.Q6J("matAutocomplete",q),e.xp6(1),e.Q6J("displayWith",o.displayUser),e.xp6(3),e.Q6J("ngForOf",o.selectable.processLead),e.xp6(4),e.Q6J("matAutocomplete",c),e.xp6(1),e.Q6J("displayWith",o.displaySelectable),e.xp6(3),e.Q6J("ngForOf",o.selectable.affectedProcess),e.xp6(5),e.Q6J("matAutocomplete",le),e.xp6(1),e.Q6J("displayWith",o.displaySelectable),e.xp6(3),e.Q6J("ngForOf",o.selectable.howDetected),e.xp6(4),e.Q6J("matAutocomplete",se),e.xp6(1),e.Q6J("displayWith",o.displaySelectable),e.xp6(3),e.Q6J("ngForOf",o.selectable.actionType),e.xp6(9),e.Q6J("label","Descripcion de la evicencia *"),e.xp6(2),e.Q6J("styles",e.DdM(32,N)),e.xp6(1),e.Q6J("label","Descripcion del hallazgo o mejora *"),e.xp6(2),e.Q6J("styles",e.DdM(33,N))}},directives:[_.Hw,n._Y,n.JL,n.sg,m.KE,m.hX,T.Nt,n.Fj,u.hl,n.JJ,n.u,u.nW,m.R9,u.Mq,f.ZL,f.XC,W.sg,F.Yh,g.SP,g.uX,J.g6,A.lW,$.ey],styles:[""],encapsulation:2}),a})();var ee=i(904),te=i(44522),oe=i(88182),ie=i(80336),ne=i(15304);const Q=[{path:"",component:V}];let ae=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[y.s,x.K,S.o,{provide:te.TP,useClass:oe.X,multi:!0}],imports:[[v.Bz.forChild(Q),A.ot,I.vV,U.Hi,u.FA,R.t,m.lN,_.Ps,T.c,G.Tx,O.Yd,D.LD,ee.p9,F.Ad,w.$A,Y.m,n.u5,ie.Co,f.Bb,J.fi.forRoot({modules:{syntax:!0,toolbar:[["bold","italic","underline"],[{align:[]},{list:"ordered"},{list:"bullet"}],["clean"]]}}),ne.Is,g.Nh]]}),a})()}}]);